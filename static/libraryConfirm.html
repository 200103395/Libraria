<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Library account confirmation</title>
    <link rel="icon" type="image/jpg" href="https://static.vecteezy.com/system/resources/thumbnails/002/219/582/small_2x/illustration-of-book-icon-free-vector.jpg">
    <link rel="stylesheet" href="/static/header.css" type="text/css">
</head>
<body>

<nav>
    <input type="checkbox" id="check">
    <label for="check" class="checkbtn">
        <i class="fas fa-bars"></i>
    </label>
    <a href="/."><label class="logo">Libraria</label></a>

    <ul>
        <li><a class="active" href="/.">Home</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="/search"><label>Search</label></a></li>
        <div class="dropdown" id="dropdown1">
            <li><a href="#" class="login">Login</a></li>
            <div class="dropdown-content">
                <a href="/account/login">User</a>
                <a href="/library/login">Library</a>
            </div>
        </div>
        <div class="dropdown2" id="dropdown2">
            <li><a href="#">Register</a></li>
            <div class="dropdown-content2">
                <a href="/account/register">User</a>
                <a href="/library/register">Library</a>
            </div>
        </div>
    </ul>
</nav>
<h1 style="margin-top: 20px; text-align: center;">Library account has been successfully created</h1>
<script>
    window.onload = fetchAccount;
    function fetchAccount() {
        let account;
        fetch('/getAuth').then(response => response.json())
            .then(data => {
                account = data;
                if( data.hasOwnProperty('error')) {
                    console.log("Has error");
                } else {
                    console.log("Doesn't have error", JSON.stringify(data));
                    let drop1 = document.getElementById('dropdown1');
                    let drop2 = document.getElementById('dropdown2');
                    let li1 = document.createElement('li');
                    let li2 = document.createElement('li');
                    drop1.innerHTML = '';
                    drop2.innerHTML = '';
                    let link = document.createElement('a');
                    link.href = '/account/' + account.id;
                    link.innerText = account.firstName + ' ' + account.lastName;
                    link.style.textDecoration = "none";
                    link.style.color = "white";
                    li1.appendChild(link);
                    drop1.appendChild(li1);
                    let out = document.createElement('a');
                    out.innerText = "Log Out";
                    out.style.textDecoration = "none";
                    out.style.color = "white";
                    out.addEventListener("click", function() {
                        let result = confirm("Are you sure you want to logout?");
                        if(result) {
                            window.location.href = '/unAuthorize';
                        }
                    });
                    li2.appendChild(out);
                    drop2.appendChild(li2);
                }
            })
            .catch(error => {
                console.error('Error fetching account information: ', error);
            });
        console.log(account);
    }
</script>
</body>
</html>